1. User Roles & Authentication
Target User: Authorized Travel Agents only (Internal/B2B).

Registration: Agents must provide credentials (and potentially business verification) to create an account.

Secure Login: Email/Password-based authentication with session management (token-based).

2. Flight Discovery (Amadeus Integration)
Airport Search: * Global search capability by City name or IATA code (e.g., "London" or "LHR").

Flight Search Criteria: * Passenger Count: Multi-category input (Adults, Children, Infants).

Travel Class: Economy, Premium Economy, Business, First Class.

Fare Types: Option to select Regular, Student, Senior Citizen, or Corporate fares.

Search Results & Display:

Real-time listing of available flights.

Toggle View: Ability to switch between "Net Fare" (Agent cost) and "Published Fare" (Agent cost + Markup).

3. Advanced Filtering & Sorting
Filters: * Time: Selectable time ranges for Departure/Arrival.

Stops: Non-stop, 1 stop, or 2+ stops.

Budget: Dynamic price slider based on result range.

Airlines: Multi-select checklist of available carriers.

Sorting: * Categorical sorting: Recommended (All), Cheapest (Lowest), Fastest, and Direct (Non-stop).

4. Booking & Markup Management
Markup Logic: * Agents can define a global markup or adjust markup per-booking.

If "Offer Price" is locked during booking, the markup remains fixed.

Price Validation: * Mandatory Step: The system must call the "Get Latest Price" API immediately before the payment stage to prevent booking with stale prices.

Traveller Info: Data entry for passenger names, passport details (if international), and frequent flyer info.

5. Financials & Payments (Excellis & Razorpay)
Payment Orchestration:

Dual Wallet System: Support for a "Normal Wallet" (pre-paid) and "Credit Wallet" (post-paid/limit-based).

External Gateway: Integration with Razorpay for direct Top-ups or Bookings.

Transaction Flow:

Initiate: Create payment record in Excellis.

Execution: Verify sufficient balance in selected wallet OR redirect to Razorpay.

Verification: Backend confirmation of fund transfer before issuing the ticket.

Failure Handling: Redirect to a "Booking Failed" screen with specific error codes (e.g., Insufficient Funds, Seat Sold Out).

6. Post-Booking & Reporting
Booking Management: * Search/Filter history by Reference ID, Status (Pending, Confirmed, Cancelled), or Date Range.

Document Management:

Invoices: Generate PDF invoice reflecting the final price (including markup).

E-Pass/Tickets: Downloadable only after the payment status is marked "Paid."

Markup Post-Edit: * Allow markup updates on existing bookings only if the original booking was made using the "Offer Price" toggle.

7. Wallet & Profile
Wallet Management: View balance history, transaction logs, and credit limits.

Profile: Edit agency details, contact info, and security settings.